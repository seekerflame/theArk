# SEC_001: Security & Encryption Protocol

> [!IMPORTANT]
> **Sovereign Security Principle**: Trust no middleman. Encrypt at the edge. Authenticate at the core.

## 1. Current Architecture: The "Double Vault"

Our current mesh (NetBird + SSH) uses a "Double Vault" approach:

1. **Layer 1: WireGuard (NetBird)**: Provides a Peer-to-Peer encrypted tunnel. Uses `ChaCha20` for symmetric encryption and `Curve25519` for key exchange. Data flows directly between nodes.
2. **Layer 2: SSH (SCP/RSYNC)**: Even *inside* the secure tunnel, we use SSH. This provides a second layer of authentication (Public Keys) and encryption (AES-256).

**Conclusion**: Man-in-the-middle is mathematically infeasible at current compute scales.

## 2. Alternatives (No NetBird)

If NetBird is unavailable or untrusted, use these fallbacks:

| Method | Sovereignty | Speed | Best For |
| :--- | :--- | :--- | :--- |
| **Raw WireGuard** | High (100%) | Max | Advanced users; direct IP-to-IP. |
| **Tor Onion** | Max (Anonymous) | Low | "Silent Refusal" / High-risk comms. |
| **Tailscale/ZeroTier** | Medium | High | Compatibility and ease of use. |
| **Sneakernet (Physical)**| Absolute | N/A | High-density files (SSD Swapping). |

## 3. Vulnerability Disclosure

- **Key Theft**: If your private key (`~/.ssh/id_rsa`) is stolen, your node is compromised.
- **Management Server**: In NetBird Cloud, the control plane is centralized. **Mitigation**: Move to a self-hosted NetBird Management server or raw WireGuard.

## 4. Modular Sharding & Secret Swarms (Evolution Phase 2)

As we scale to decentralized squads, we avoid "Large Blast Radii" by sharding communications:

- **Team Sharding**: Chat and mission data are sharded by UUID. Only nodes participating in a specific Swarm have the permission (and keys) to fetch those shards.
- **Secret Swarms**: Specific shards can be wrapped in **AES-256-GCM** with keys exchanged via **Sovereign RSA-4096** public keys. This ensures that even if the main ledger is public, Swarm-private data remains unreadable to non-members.

## 5. The "Type 6" Goal

Transition to **Fully P2P Gossip Protocols** (IPFS/Libp2p) where no management server exists, only the mesh.
